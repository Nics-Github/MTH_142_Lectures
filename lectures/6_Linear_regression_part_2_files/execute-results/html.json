{
  "hash": "df9afe060af30ef24cec114d06ab0e3f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Linear Regression part 2\"\nauthor: \"Schwab\"\nformat: \n  revealjs:\n    theme: beige\neditor: visual\nexecute: \n  echo: TRUE\n---\n\n\n## Cats\n\n![Cat's hearts](https://petlifesa.com/wp-content/uploads/2019/08/SA0057-Petlifesa-health-conditions-diseases-heart-disease-facts-about-your-cats-heart-Header-FA.jpg){fig-align=\"center\"}\n\n## Cats' hearts\n\n![You stole Meow Heart](https://drbillspetnutrition.com/wp-content/uploads/2017/01/1.-Feline-Heart-1.jpg){fig-align=\"center\"}\n\n## A big heart may cause problems\n\nFinding the size of a cat's heart is hard.\n\nEstimate with a model a model.\n\n## Data from the 40s\n\nThis data cites [this source,](https://digital.library.adelaide.edu.au/dspace/bitstream/2440/15253/1/211.pdf) which you may be inclined to look over.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\n#install.packages(\"MASS\")\nlibrary(MASS)\n```\n:::\n\n\n## Look at data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?cats\ntail(cats,6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Sex Bwt  Hwt\n139   M 3.6 15.0\n140   M 3.7 11.0\n141   M 3.8 14.8\n142   M 3.8 16.8\n143   M 3.9 14.4\n144   M 3.9 20.5\n```\n\n\n:::\n:::\n\n\n## Which variable is which?\n\nWhich should be the predictor and response variables?\n\n## Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](6_Linear_regression_part_2_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n## Describe Trend\n\n-   Shape\n\n-   Direction\n\n-   Strength\n\n## Add a regression line\n\nand some labels.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = cats, aes(x = Bwt, y = Hwt))+\n  geom_point(aes(color=Sex) )+\n  geom_smooth(method = lm, se = FALSE) +\n  xlab(\"Body Weight in Kg\") +\n  ylab(\"Heart Weight in Grams\")\n```\n\n::: {.cell-output-display}\n![](6_Linear_regression_part_2_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n## Find correlation coefficient\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarize(.data= cats , r = cor(Bwt, Hwt, use=\"complete.obs\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          r\n1 0.8041274\n```\n\n\n:::\n:::\n\n\n## Find the coefficents\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"broom\")\nlibrary(broom)\ncat_model <- lm(Hwt ~ Bwt, data = cats)\ntidy(cat_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 Ã— 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   -0.357     0.692    -0.515 6.07e- 1\n2 Bwt            4.03      0.250    16.1   6.97e-34\n```\n\n\n:::\n:::\n\n\n## The Equation\n\nIntercept is the y-intercept of our linear model ($\\beta_0 = -0.36$).\n\nThe number next to Bwt is the slope ($\\beta_1 = 4.03$).\n\nThe equations is: $$\n\\hat{y} = \\beta_0 + \\beta_1 x \\\\\n\\text{or} \\\\\n\\widehat{Hwt} = -0.36 + 4.03 \\times Bwt $$\n\n## Summary\n\n![](images/lm_cats_1_predictor.png) Stolen from Prof Kurtz Garcia at Smith College\n\n## Interpretation\n\nSlope: For every *kilogram* increase in body weight we expect a 4.03 *gram* increase in the heart weight.\n\nIntercept: If we found a cat they weighed nothing its heart would be -0.36 grams?\n\n## More Complete outputs\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Alternative to tidy()\nsummary(cat_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Hwt ~ Bwt, data = cats)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5694 -0.9634 -0.0921  1.0426  5.1238 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -0.3567     0.6923  -0.515    0.607    \nBwt           4.0341     0.2503  16.119   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.452 on 142 degrees of freedom\nMultiple R-squared:  0.6466,\tAdjusted R-squared:  0.6441 \nF-statistic: 259.8 on 1 and 142 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## You try: \n\n::: incremental\n-   If a cat weighs 3.5 kg how large a heart would we expect?\n\n-   Can we estimate the heart size for a 5kg cat?\n\n    -   Caution against extrapolation.\n:::\n\n## Solution: \n\nThe equation for the line is\n\n$\\widehat{Hwt} = -0.36 + 4.03 \\times Bwt $\n\nPlug in 3.5 we get\n\n$\\widehat{Hwt} = -0.36 + 4.03 \\times 3.5 \\\\\n\\widehat{Hwt} = 13.745 \\approx 13.7\n$\n\n# Residuals\n\nResiduals are the difference in the observed values and the predicted value.\n\n$$e = y - \\hat{y}$$\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](6_Linear_regression_part_2_files/figure-revealjs/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\n## You try:  calculate a residual\n\nThere is a cat in this data that has a heart weight of 11.7 grams and a body weight of 3.5 grams. Calculate the residual for this cat.\n\n## Solution: \n\nThe residual is calculated $$e = y - \\hat{y}$$\n\nWe previously found the value of $\\hat{y} = 13.7$ and we are told $y=11.7$ So we need to subtract those two values to get\n\n$$e = y - \\hat{y}\\\\\ne = 11.7-13.7\\\\\ne = -2$$\n\n## Solution with R functions\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(object =  cat_model, \n        newdata = data.frame(Bwt = 3.5)\n        )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       1 \n13.76256 \n```\n\n\n:::\n:::\n\n\n## Citations\n\nStreet cats from <https://petlifesa.com/wp-content/uploads/2019/08/SA0057-Petlifesa-health-conditions-diseases-heart-disease-facts-about-your-cats-heart-Header-FA.jpg>\n\nYou stole Meow Heart https://drbillspetnutrition.com/feline-heart-conditions/\n",
    "supporting": [
      "6_Linear_regression_part_2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}